<nav layout:fragment="sidebar" id="sidebar" class="bg-gray-800 text-white w-64 min-h-screen transition-all duration-300 ease-in-out overflow-hidden p-4">
    <!-- Header Sidebar -->
    <div class="flex justify-between items-center">
        <h1 id="sidebarTitle" class="text-xl font-bold transition-all duration-300">Trang Sinh ViÃªn</h1>
        <button id="toggleBtn" class="text-white focus:outline-none">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </div>

    <!-- ThÃ´ng bÃ¡o -->
    <a th:href="@{/notifications/student/{studentId}(studentId=${session.student?.studentId})}" class="flex items-center justify-between bg-white p-2 rounded shadow my-4 hover:bg-gray-50">
        <span class="text-gray-700 sidebar-text">ThÃ´ng bÃ¡o</span>
        <div id="notificationBadge" class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center">0</div>
    </a>

    <hr class="my-4 border-gray-300">

    <!-- Danh sÃ¡ch menu -->
    <ul class="space-y-2">
        <li><a th:href="@{/student/home}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ </span><span class="ml-3 sidebar-text">Trang chá»§</span></a></li>
        <li><a th:href="@{/register-dormitory}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ¢</span><span class="ml-3 sidebar-text">ÄÄƒng kÃ½ á»Ÿ KTX</span></a></li>
        <li><a th:href="@{/student/services}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ”§</span><span class="ml-3 sidebar-text">Dá»‹ch vá»¥</span></a></li>
        <li><a th:href="@{/student-service-registrations/list}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ”§</span><span class="ml-3 sidebar-text">Lá»‹ch sá»­ Ä‘Äƒng kÃ½ dá»‹ch vá»¥</span></a></li>
        <li><a th:href="@{/bills/filter}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ’³</span><span class="ml-3 sidebar-text">HÃ³a Ä‘Æ¡n</span></a></li>
        <li><a th:href="@{/student/profile}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">ğŸ‘¤</span><span class="ml-3 sidebar-text">Há»“ sÆ¡ cÃ¡ nhÃ¢n</span></a></li>
        <li><a th:href="@{/settings}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">âš™ï¸</span><span class="ml-3 sidebar-text">CÃ i Ä‘áº·t</span></a></li>
        <li><a th:href="@{/help}" class="flex items-center p-2 rounded hover:bg-gray-700"><span class="w-6 h-6 flex items-center justify-center">â“</span><span class="ml-3 sidebar-text">Trá»£ giÃºp</span></a></li>
        <li>
            <form th:action="@{/logout}" method="post" class="flex items-center p-2 rounded hover:bg-gray-700">
                <span class="w-6 h-6 flex items-center justify-center">ğŸšª</span>
                <button type="submit" class="ml-3 sidebar-text">ÄÄƒng xuáº¥t</button>
            </form>
        </li>
    </ul>




    <!-- Script xá»­ lÃ½ Sidebar -->
    <script>
        const sidebar = document.getElementById('sidebar');
        const sidebarText = document.querySelectorAll('.sidebar-text');
        const sidebarTitle = document.getElementById('sidebarTitle');
        const toggleBtn = document.getElementById('toggleBtn');
        toggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('w-64');
            sidebar.classList.toggle('w-16');
            sidebarTitle.classList.toggle('hidden');
            sidebarText.forEach(text => text.classList.toggle('hidden'));
        });
    </script>

    <!-- Script xá»­ lÃ½ Dropdown -->
    <script>
        const dropdownBtn = document.getElementById('dropdownButton');
        if (dropdownBtn) {
            const dropdownMenu = document.getElementById('dropdownMenu');
            dropdownBtn.addEventListener('click', () => {
                dropdownMenu?.classList.toggle('hidden');
            });
        }

    </script>

    <!-- Script cáº­p nháº­t sá»‘ lÆ°á»£ng thÃ´ng bÃ¡o -->
    <!-- NhÃºng biáº¿n studentId tá»« server -->
    <script th:inline="javascript">
        /*<![CDATA[*/
        const studentId = /*[[${session.student.studentId}]]*/ 0;
        /*]]>*/
    </script>

    <!-- Script cáº­p nháº­t sá»‘ lÆ°á»£ng thÃ´ng bÃ¡o -->
    <script>
<!--        function pollNotifications() {-->
<!--            fetch('/notifications/poll?studentId=' + studentId)-->
<!--                .then(response => response.json())-->
<!--                .then(data => {-->
<!--                    console.log('Sá»‘ lÆ°á»£ng thÃ´ng bÃ¡o:', data.length);-->
<!--                    document.getElementById('notificationBadge').innerText = data.length;-->
<!--                })-->
<!--                .catch(error => console.error('Lá»—i khi polling thÃ´ng bÃ¡o:', error));-->
<!--        }-->
<!--        setInterval(pollNotifications, 3000);-->
<!--        pollNotifications();-->
    </script>

</nav>