<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Room Service Usage</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script>
        // Lưu thông tin lọc vào localStorage khi submit form
        function saveFilters() {
            localStorage.setItem('roomId', document.getElementById('roomId').value);
            localStorage.setItem('roomNumber', document.getElementById('roomNumber').value);
            localStorage.setItem('recordDate', document.getElementById('recordDate').value);
            localStorage.setItem('serviceName', document.getElementById('serviceName').value);
        }
        // Nạp lại thông tin lọc từ localStorage khi trang được tải
        function loadFilters() {
            if(localStorage.getItem('roomId')) {
                document.getElementById('roomId').value = localStorage.getItem('roomId');
            }
            if(localStorage.getItem('roomNumber')) {
                document.getElementById('roomNumber').value = localStorage.getItem('roomNumber');
            }
            if(localStorage.getItem('recordDate')) {
                document.getElementById('recordDate').value = localStorage.getItem('recordDate');
            }
            if(localStorage.getItem('serviceName')) {
                document.getElementById('serviceName').value = localStorage.getItem('serviceName');
            }
        }
        document.addEventListener("DOMContentLoaded", loadFilters);
    </script>
</head>
<body>
<div class="container mt-4">
    <h1>Room Service Usage</h1>
    <form method="get" onsubmit="saveFilters()">
        <div class="row mb-3">
            <div class="col-md-3">
                <label for="roomId" class="form-label">Room ID</label>
                <input type="number" id="roomId" name="roomId" class="form-control" th:value="${roomId}">
            </div>
            <div class="col-md-3">
                <label for="roomNumber" class="form-label">Room Number</label>
                <input type="text" id="roomNumber" name="roomNumber" class="form-control" th:value="${roomNumber}">
            </div>
            <div class="col-md-3">
                <label for="recordDate" class="form-label">Record Date</label>
                <input type="date" id="recordDate" name="recordDate" class="form-control" th:value="${recordDate}">
            </div>
            <div class="col-md-3">
                <label for="serviceName" class="form-label">Service Name</label>
                <input type="text" id="serviceName" name="serviceName" class="form-control" th:value="${serviceName}">
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Filter</button>
    </form>

    <table class="table table-striped mt-4">
        <thead>
        <tr>
            <th>Room ID</th>
            <th>Room Number</th>
            <th>Record Date</th>
            <th>Service Name</th>
            <th>Unit</th>
            <th>Previous Reading</th>
            <th>Current Reading</th>
            <th>Consumption</th>
            <th>Unit Price</th>
            <th>Total Cost</th>
        </tr>
        </thead>
        <tbody>
       <tr th:each="usage : ${result.content}">
           <td th:text="${usage.id.roomId}"></td>
           <td th:text="${usage.roomNumber}"></td>
           <td th:text="${usage.id.recordDate}"></td>
           <td th:text="${usage.id.serviceName}"></td>
            <td th:text="${usage.unit}"></td>
            <td th:text="${usage.previousReading}"></td>
            <td th:text="${usage.currentReading}"></td>
            <td th:text="${usage.consumption}"></td>
            <td th:text="${usage.unitPrice}"></td>
            <td th:text="${#numbers.formatDecimal(usage.totalCost, 0, 'COMMA', 2, 'POINT')}"></td>
        </tr>
        </tbody>
    </table>

    <!-- Phân trang -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <li class="page-item" th:classappend="${result.first} ? 'disabled'">
                <a class="page-link" th:href="@{/room-service-usage(page=${result.number - 1}, roomId=${roomId}, roomNumber=${roomNumber}, recordDate=${recordDate}, serviceName=${serviceName})}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" th:each="i : ${#numbers.sequence(0, result.totalPages - 1)}"
                th:classappend="${i == result.number} ? 'active'">
                <a class="page-link" th:href="@{/room-service-usage(page=${i}, roomId=${roomId}, roomNumber=${roomNumber}, recordDate=${recordDate}, serviceName=${serviceName})}"
                   th:text="${i + 1}"></a>
            </li>
            <li class="page-item" th:classappend="${result.last} ? 'disabled'">
                <a class="page-link" th:href="@{/room-service-usage(page=${result.number + 1}, roomId=${roomId}, roomNumber=${roomNumber}, recordDate=${recordDate}, serviceName=${serviceName})}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
</body>
</html>
